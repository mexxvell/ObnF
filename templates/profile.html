{% extends "layout_base.html" %}
{% block content %}
<div class="page page-profile">
  <h2>Профиль</h2>
  {% if session.get('user_id') %}
    {% set uid = session.get('user_id') %}
    <div id="profile-card">
      <p>Пользователь: {{ uid }}</p>
      <!-- данные будут подгружаться фронтендом через API -->
      <div id="profile-stats">
        <p>Уровень: <span id="level">—</span></p>
        <p>XP: <span id="xp">—</span></p>
        <p>Бейджи: <span id="badges">—</span></p>
        <p>Реф. ссылка: <input id="ref-link" readonly value="{{ request.host_url|trim('/') ~ '/miniapp?ref=' ~ uid }}"></p>
      </div>
    </div>
  {% else %}
    <p>Не авторизован</p>
  {% endif %}
</div>

<script>
  // загрузка данных профиля
  async function loadProfile(){
    const res = await fetch('/miniapp/notifications'); // re-use endpoint if you have an API; else create /miniapp/profile_api
    // placeholder: request user data endpoint later
  }
  document.addEventListener('DOMContentLoaded', loadProfile);
</script>
{% endblock %}
